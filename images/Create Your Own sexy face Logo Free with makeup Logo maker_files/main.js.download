jQuery(window).load(function(a){var b=new SocialXc;b.log("INIT : SocialXcid initialized"),jQuery(".xc-social-container.xc-social .facebook").length>0&&b.initFacebook(),jQuery(".xc-social-container.xc-social a.twitter").length>0&&b.initTwitter(),jQuery(".xc-social-container.xc-social a.vk").length>0&&b.initVk(),jQuery(".xc-social-container.xc-social a.linkedin").length>0&&b.initLinkedin()});var SocialXc=function(){var a=this;a.initFacebook=function(){var b=xc_social_reward_facebook_params.locale;jQuery.ajaxSetup({cache:!0}),jQuery.getScript("//connect.facebook.net/"+b+"/all.js#xfbml=1&appId="+xc_social_reward_facebook_params.app_id,function(){a.log("FB : Initialized"),FB.init({appId:xc_social_reward_facebook_params.app_id||null}),FB.Event.subscribe("edge.remove",function(b){a.log("FB : Unlike button clicked"),b&&a.post("facebook","unlike")}),FB.Event.subscribe("edge.create",function(b){a.log("FB : Like button clicked"),b&&a.post("facebook","like")}),FB.XFBML.parse()}),jQuery(".xc-social-container a.facebook.share").click(a.shareOnFacebook),jQuery(".xc-social-container a.facebook.fake-like").click(function(){FB.login()})},a.initVk=function(){jQuery.getScript("//vk.com/js/api/openapi.js?117",function(){a.log("VK : Initialized"),VK.init({apiId:xc_social_reward_vk_params.app_id||null}),jQuery(".xc-social-container a.vk.like").length>0&&VK.Widgets.Like("xc_vk_like",{type:"button",height:20},xc_social_reward_vk_params.page_id||null),VK.Observer.subscribe("widgets.like.liked",function(){a.post("vk","like")}),VK.Observer.subscribe("widgets.like.unliked",function(){a.post("vk","unlike")})})},a.shareOnFacebook=function(){FB.ui({method:"feed",link:xc_social_reward_facebook_params.share_url||null,caption:xc_social_reward_facebook_params.share_title||null,description:xc_social_reward_facebook_params.share_message||null,picture:xc_social_reward_facebook_params.share_image||null},function(b){a.log("FB : Callback share"),"undefined"!=typeof b&&(a.log("FB : Shared"),a.post("facebook","share"))})},a.initTwitter=function(){jQuery(".xc-twitter-share-button").unbind().bind("click",function(){jQuery.when(a.loginTwitter()).then(function(b){a.showTweetContainer(b.oauth_token,b.oauth_verifier)})}),jQuery(".xc-twitter-follow-button").unbind().bind("click",function(){jQuery.when(a.loginTwitter()).then(function(a){var b={action:"xc_make_twitter_action",oauth_token:a.oauth_token||null,oauth_verifier:a.oauth_verifier||null,product_id:xc_social_reward_product_id.post_id||null,type:"follow"};jQuery.post(woocommerce_params.ajax_url,b,function(a){window.location.reload()})})})},a.loginTwitter=function(){var a=jQuery.Deferred(),b=window.open(xc_social_reward_twitter_params.url,"","toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=800,height=450");return window.twitterCallback=function(c,d){b.close(),a.resolve({oauth_token:c||null,oauth_verifier:d||null})},a.promise()},a.showTweetContainer=function(a,b){jQuery(".xc-tweet-container").fadeIn(),jQuery(".xc-tweet-container button.valid").unbind().bind("click",function(){var c={action:"xc_make_twitter_action",oauth_token:a||null,oauth_verifier:b||null,product_id:xc_social_reward_product_id.post_id||null,type:"tweet",tweet:jQuery(".xc-tweet-container textarea").val()};jQuery.post(woocommerce_params.ajax_url,c,function(a){window.location.reload()})}),jQuery(".xc-tweet-container button.cancel").unbind().bind("click",function(){jQuery(".xc-tweet-container").fadeOut()})},a.initLinkedin=function(){jQuery(".xc-linkedin-share-button").unbind().bind("click",function(){jQuery.when(a.loginLinkedin()).then(function(b){a.showShareLinkedinContainer(b.code,b.state)})})},a.loginLinkedin=function(){var a=jQuery.Deferred(),b=window.open(xc_social_reward_linkedin_params.url,"","toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=800,height=450");return window.linkedinCallback=function(c,d){b.close(),a.resolve({code:c||null,state:d||null})},a.promise()},a.showShareLinkedinContainer=function(a,b){jQuery(".xc-linkedin-container").fadeIn(),jQuery(".xc-linkedin-container button.valid").unbind().bind("click",function(){var c={action:"xc_make_linkedin_action",code:a||null,state:b||null,product_id:xc_social_reward_product_id.post_id||null,message:jQuery(".xc-linkedin-container textarea").val()};jQuery.post(woocommerce_params.ajax_url,c,function(a){window.location.reload()})}),jQuery(".xc-linkedin-container button.cancel").unbind().bind("click",function(){jQuery(".xc-linkedin-container").fadeOut()})},a.post=function(b,c){var d={action:"xc_handle_social_response",product_id:xc_social_reward_product_id.post_id||null,network:b,type:c};a.log("POST : Send coupon to backend"),jQuery.post(woocommerce_params.ajax_url,d,function(b){xc_social_reward_global_params.debug||(xc_social_reward_global_params.debug?a.log(b):"yes"===b.redirect?(a.log("POST : Reload page to apply coupon"),window.location=b.cart_page):window.location.reload())})},a.log=function(a){xc_social_reward_global_params.debug&&console.log("[XCRT]",a)}};